
## 13. 로그 파일에서 필요한 줄만 뽑기(파이프 라인)

```
$ less "파일명"
# 파일 내용을 확인하는 명령어

$ grep -r "orange" /var/log/apache
          찾을 내용   파일을 찾을 디렉토리

# 재귀적으로 찾음
# 찾을 내용과 찾을 내용을 포함하고 있는 파일을 보여준다



$ grep "orange" /var/log/apache/access.log
       찾을 내용    대상 파일
       
# -r 옵션 없으면 파일 안에서 지정한 내용을 포함한 줄을 찾을 수 있다
```

<hr>

- 파이프라인은 | 을 사용해서 명령어 양쪽을 연결하는 것을 말한다 

```
$ grep "/retro" access.log.1 | less
        출력을 넘기는 명령어         출력을 받는 명령어
        
$ grep "/retro" access.log.1 | grep -v "/live" | less
                        지정한 문자열을 포함하지 않는 줄만 출력


```

- 오래된 로그 파일은 디스크 용량을 아끼기 위해 압축할ㄴ다
- 압축 파일은 grep을 직접 쓸 수 없다
- 매번 압축 파일을 푸는 대신 zcat을 사용한다
    - cat : 비 압축 텍스트 파일용
    - zcat : gzip용 (.gz, tgz)
    - xzcat : xz 형식용 (.xz)
    - unzip -p : zip 형식

```
$ cat "파일명"

$ zcat access.log.2.gz | grep "/retro" 
```

- 지금 이 순간의 로그를 확인하기 위한 방법으로 tail 명령어를 사용한다 
- tail 명령어의 -F 옵션을 지정하면 파일 변경을 감시해서 내용이 추가될 때마다 그 부분을 실시간으로 출력한다 

```
$ tail -F access.log | grep "/retro" | grep -v "live"
```

<hr>

- 텍스트를 다루는 명령어는 명령어에도 파이프라인을 연결해서 출력을 좁힐 수 있다


- 파일 내용을 다음 명령어에 출력하는 시작 그룹
    - cat, zcat, xzcat : 파일 내용을 읽어서 출력

    - tail -F : 파일에 추가된 부분을 출력

- 중간에 이전 명령어 출력을 가공하는 중간 그룹
    - grep : 해당하는 줄만 출력
    - sort : 재정렬
    - cut : 내용을 잘라냄
    - uniq : 중복된 것 제거
    - sed, awk : 내용 변경
    
- 이전 명령어 출력을 가공하는 최종 그룹
    - less : 스크롤 할 수 있게 출력
    - tee : 파일을 저장
    - wc : 줄 수나 문자 수를 카운트
    - head : 첫 부분만 출력
    
    

<hr>

- 파이프라인을 사용하면 명령어끼리 조합해서 사용가능
- grep은 다른 명렁어 출력을 가공하는 데도 사용가능
- zcat을 사용하면 압축된 로그파일 에서 바로 파이프 라인으로 연결가능
