
## Ch18. 같은 내용의 줄을 세어보는 방법(Sort, uniq)

- 아래와 같은 순서로 진행하는 명령어를 실행하고 싶을 때 
    - 적절하지 않은 줄을 제외하고 필요한 줄만 집계 대상으로 삼음
    - 로그 각 줄에서 접속한 페이지 경로를 추출
    - 경로 등장 횟수를 카운트
    - 등장 횟수로 경로를 재정렬
    - 상위와 하위 항목을 추출

- 파일 내용 출력
    - cat /var/log/apache2/access.log 
- 집계 대상이 아닌 줄을 제외
    - grep -v "/live"
- 로그 안에서 접속한 페이지 경로 부분만 추출
    - cut -d " " -f 7


```
#  적절하지 않은 줄을 제외하고 필요한 줄만 집계 대상으로 삼음

$ cat /var/log/apache2/access.log | grep -v "/live" | cut -d " " -f 7
```

<hr>

- sort
    - 입력된 내용을 알파벳 순서로 재정렬하는 명령어
    - 보통 오름차순으로 정렬되지만 --reverse(-r) 옵션을 사용하면 내림차순 정렬이 된다 
 
- uniq
    - 같은 내용의 중복을 제거하는 명렁어
    - 하지만 제거하는 것은 이어진 중복 뿐이기에 중복되는 명령어가 이어져 있지 않은 경우에는 제거 되지 않는다
    - 따라서 sort를 한 다음 중복 제거를 한다 
    - --count(-c) 옵션 사용하면 uniq 실행 결과에 각각 내용이 몇 번 등장했는지 출력한다 
    
- head
    - 앞부분에서 10줄만 출력하는 명령어
    - -n 옵션 으로 출력하는 줄 수 변경 가능 
    - -n+6 처럼 +숫자 사용시 숫자 번째 이후로 출력

- tail
    - 파일이나 파이이프라인 입력 끝에서 10줄만 출력
    - -n 옵션 으로 출력하는 줄 수 변경 가능 
    - -n+6 처럼 +숫자 사용시 숫자 번째 이후로 출력



```
#!/bin/bash
log =/var/log/apache2/access.log
count = 10

echo="접속자 수가 많은 ${count}개 페이지"
$ cat $log | grep -v "/live" | cut -d " " -f 7 |sort | uniq -c | sort -r | head -n $count

```


### Reference

  - [만화로 배우는 리눅스 시스템 관리](http://www.yes24.com/Product/Goods/32402055?Acode=101)
